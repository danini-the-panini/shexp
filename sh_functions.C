void SH_product(const double *a, const double *b, double *c)
{
  double ta, tb, t;

  // [0,0]: 0
  c[0] = 0.282095*b[0]*a[0];

  // [1,1]: 0, 6, 8
  ta = 0.282095*a[0] + -0.126157*a[6] + -0.218508*a[8];
  tb = 0.282095*b[0] + -0.126157*b[6] + -0.218508*b[8];
  c[1] = ta*b[1] + tb*a[1];
  t = a[1]*b[1];
  c[0] += 0.282095*t;
  c[6] = -0.126157*t;
  c[8] = -0.218508*t;

  // [1,2]: 5
  ta = 0.21851*a[5];
  tb = 0.21851*b[5];
  c[1] += ta*b[2] + tb*a[2];
  c[2] = ta*b[1] + tb*a[1];
  t = a[1]*b[2] + a[2]*b[1];
  c[5] = 0.21851*t;

  // [1,3]: 4
  ta = 0.218512*a[4];
  tb = 0.218512*b[4];
  c[1] += ta*b[3] + tb*a[3];
  c[3] = ta*b[1] + tb*a[1];
  t = a[1]*b[3] + a[3]*b[1];
  c[4] = 0.218512*t;

  // [2,2]: 0, 6
  ta = 0.282095*a[0] + 0.252312*a[6];
  tb = 0.282095*b[0] + 0.252312*b[6];
  c[2] += ta*b[2] + tb*a[2];
  t = a[2]*b[2];
  c[0] += 0.282095*t;
  c[6] += 0.252312*t;

  // [2,3]: 7
  ta = 0.21851*a[7];
  tb = 0.21851*b[7];
  c[2] += ta*b[3] + tb*a[3];
  c[3] += ta*b[2] + tb*a[2];
  t = a[2]*b[3] + a[3]*b[2];
  c[7] = 0.21851*t;

  // [3,3]: 0, 6, 8
  ta = 0.282095*a[0] + -0.126157*a[6] + 0.218507*a[8];
  tb = 0.282095*b[0] + -0.126157*b[6] + 0.218507*b[8];
  c[3] += ta*b[3] + tb*a[3];
  t = a[3]*b[3];
  c[0] += 0.282095*t;
  c[6] += -0.126157*t;
  c[8] += 0.218507*t;

  // [4,4]: 0, 6
  ta = 0.282098*a[0] + -0.180226*a[6];
  tb = 0.282098*b[0] + -0.180226*b[6];
  c[4] += ta*b[4] + tb*a[4];
  t = a[4]*b[4];
  c[0] += 0.282098*t;
  c[6] += -0.180226*t;

  // [4,5]: 7
  ta = 0.15608*a[7];
  tb = 0.15608*b[7];
  c[4] += ta*b[5] + tb*a[5];
  c[5] += ta*b[4] + tb*a[4];
  t = a[4]*b[5] + a[5]*b[4];
  c[7] += 0.15608*t;

  // [5,5]: 0, 6, 8
  ta = 0.282095*a[0] + 0.0901106*a[6] + -0.156078*a[8];
  tb = 0.282095*b[0] + 0.0901106*b[6] + -0.156078*b[8];
  c[5] += ta*b[5] + tb*a[5];
  t = a[5]*b[5];
  c[0] += 0.282095*t;
  c[6] += 0.0901106*t;
  c[8] += -0.156078*t;

  // [6,6]: 0, 6
  ta = 0.282094*a[0];
  tb = 0.282094*b[0];
  c[6] += ta*b[6] + tb*a[6];
  t = a[6]*b[6];
  c[0] += 0.282094*t;
  c[6] += 0.180223*t;

  // [7,7]: 0, 6, 8
  ta = 0.282095*a[0] + 0.0901122*a[6] + 0.156077*a[8];
  tb = 0.282095*b[0] + 0.0901122*b[6] + 0.156077*b[8];
  c[7] += ta*b[7] + tb*a[7];
  t = a[7]*b[7];
  c[0] += 0.282095*t;
  c[6] += 0.0901122*t;
  c[8] += 0.156077*t;

  // [8,8]: 0, 6
  ta = 0.282092*a[0] + -0.180221*a[6];
  tb = 0.282092*b[0] + -0.180221*b[6];
  c[8] += ta*b[8] + tb*a[8];
  t = a[8]*b[8];
  c[0] += 0.282092*t;
  c[6] += -0.180221*t;

  // entry count: 13
  // multiply count: 106
  // addition count: 68
}

void SH_square(const double *a, double *c)
{
  double ta, t;

  // [0,0]: 0
  c[0] = 0.282095*a[0]*a[0];

  // [1,1]: 0, 6, 8
  ta = 0.56419*a[0] + -0.252314*a[6] + -0.437016*a[8];
  c[1] = ta*a[1];
  t = a[1]*a[1];
  c[0] += 0.282095*t;
  c[6] = -0.126157*t;
  c[8] = -0.218508*t;

  // [1,2]: 5
  ta = 0.43702*a[5];
  c[1] += ta*a[2];
  c[2] = ta*a[1];
  t = a[1]*a[2];
  c[5] = 0.43702*t;

  // [1,3]: 4
  ta = 0.437024*a[4];
  c[1] += ta*a[3];
  c[3] = ta*a[1];
  t = a[1]*a[3];
  c[4] = 0.437024*t;

  // [2,2]: 0, 6
  ta = 0.56419*a[0] + 0.504624*a[6];
  c[2] += ta*a[2];
  t = a[2]*a[2];
  c[0] += 0.282095*t;
  c[6] += 0.252312*t;

  // [2,3]: 7
  ta = 0.43702*a[7];
  c[2] += ta*a[3];
  c[3] += ta*a[2];
  t = a[2]*a[3];
  c[7] = 0.43702*t;

  // [3,3]: 0, 6, 8
  ta = 0.56419*a[0] + -0.252314*a[6] + 0.437014*a[8];
  c[3] += ta*a[3];
  t = a[3]*a[3];
  c[0] += 0.282095*t;
  c[6] += -0.126157*t;
  c[8] += 0.218507*t;

  // [4,4]: 0, 6
  ta = 0.564196*a[0] + -0.360452*a[6];
  c[4] += ta*a[4];
  t = a[4]*a[4];
  c[0] += 0.282098*t;
  c[6] += -0.180226*t;

  // [4,5]: 7
  ta = 0.31216*a[7];
  c[4] += ta*a[5];
  c[5] += ta*a[4];
  t = a[4]*a[5];
  c[7] += 0.31216*t;

  // [5,5]: 0, 6, 8
  ta = 0.56419*a[0] + 0.1802212*a[6] + -0.312156*a[8];
  c[5] += ta*a[5];
  t = a[5]*a[5];
  c[0] += 0.282095*t;
  c[6] += 0.0901106*t;
  c[8] += -0.156078*t;

  // [6,6]: 0, 6
  ta = 0.564188*a[0];
  c[6] += ta*a[6];
  t = a[6]*a[6];
  c[0] += 0.282094*t;
  c[6] += 0.180223*t;

  // [7,7]: 0, 6, 8
  ta = 0.56419*a[0] + 0.1802244*a[6] + 0.312154*a[8];
  c[7] += ta*a[7];
  t = a[7]*a[7];
  c[0] += 0.282095*t;
  c[6] += 0.0901122*t;
  c[8] += 0.156077*t;

  // [8,8]: 0, 6
  ta = 0.564184*a[0] + -0.360442*a[6];
  c[8] += ta*a[8];
  t = a[8]*a[8];
  c[0] += 0.282092*t;
  c[6] += -0.180221*t;

  // entry count: 13
  // multiply count: 78
  // addition count: 52
}

void SH_matrix(const double *a, double *M)
{
  // compute upper triangular part of matrix
  M[0] = 0.282095*a[0];
  M[1] = 0.282095*a[1];
  M[2] = 0.282095*a[2];
  M[3] = 0.282095*a[3];
  M[4] = 0.282098*a[4];
  M[5] = 0.282095*a[5];
  M[6] = 0.282094*a[6];
  M[7] = 0.282095*a[7];
  M[8] = 0.282092*a[8];
  M[10] = 0.282095*a[0] + -0.126157*a[6] + -0.218508*a[8];
  M[11] = 0.21851*a[5];
  M[12] = 0.218512*a[4];
  M[13] = 0.218512*a[3];
  M[14] = 0.21851*a[2];
  M[15] = -0.126157*a[1];
  M[16] = 0;
  M[17] = -0.218508*a[1];
  M[20] = 0.282095*a[0] + 0.252312*a[6];
  M[21] = 0.21851*a[7];
  M[22] = 0;
  M[23] = 0.21851*a[1];
  M[24] = 0.252312*a[2];
  M[25] = 0.21851*a[3];
  M[26] = 0;
  M[30] = 0.282095*a[0] + -0.126157*a[6] + 0.218507*a[8];
  M[31] = 0.218512*a[1];
  M[32] = 0;
  M[33] = -0.126157*a[3];
  M[34] = 0.21851*a[2];
  M[35] = 0.218507*a[3];
  M[40] = 0.282098*a[0] + -0.180226*a[6];
  M[41] = 0.15608*a[7];
  M[42] = -0.180226*a[4];
  M[43] = 0.15608*a[5];
  M[44] = 0;
  M[50] = 0.282095*a[0] + 0.0901106*a[6] + -0.156078*a[8];
  M[51] = 0.0901106*a[5];
  M[52] = 0.15608*a[4];
  M[53] = -0.156078*a[5];
  M[60] = 0.282094*a[0] + 0.180223*a[6];
  M[61] = 0.0901122*a[7];
  M[62] = -0.180221*a[8];
  M[70] = 0.282095*a[0] + 0.0901122*a[6] + 0.156077*a[8];
  M[71] = 0.156077*a[7];
  M[80] = 0.282092*a[0] + -0.180221*a[6];
  // entry count: 40
  // multiply count: 52
  // addition count: 12

  // fill in lower triangular part of matrix
  M[9] = M[1]; // 1,0 = 0,1
  M[18] = M[2]; // 2,0 = 0,2
  M[19] = M[11]; // 2,1 = 1,2
  M[27] = M[3]; // 3,0 = 0,3
  M[28] = M[12]; // 3,1 = 1,3
  M[29] = M[21]; // 3,2 = 2,3
  M[36] = M[4]; // 4,0 = 0,4
  M[37] = M[13]; // 4,1 = 1,4
  M[38] = M[22]; // 4,2 = 2,4
  M[39] = M[31]; // 4,3 = 3,4
  M[45] = M[5]; // 5,0 = 0,5
  M[46] = M[14]; // 5,1 = 1,5
  M[47] = M[23]; // 5,2 = 2,5
  M[48] = M[32]; // 5,3 = 3,5
  M[49] = M[41]; // 5,4 = 4,5
  M[54] = M[6]; // 6,0 = 0,6
  M[55] = M[15]; // 6,1 = 1,6
  M[56] = M[24]; // 6,2 = 2,6
  M[57] = M[33]; // 6,3 = 3,6
  M[58] = M[42]; // 6,4 = 4,6
  M[59] = M[51]; // 6,5 = 5,6
  M[63] = M[7]; // 7,0 = 0,7
  M[64] = M[16]; // 7,1 = 1,7
  M[65] = M[25]; // 7,2 = 2,7
  M[66] = M[34]; // 7,3 = 3,7
  M[67] = M[43]; // 7,4 = 4,7
  M[68] = M[52]; // 7,5 = 5,7
  M[69] = M[61]; // 7,6 = 6,7
  M[72] = M[8]; // 8,0 = 0,8
  M[73] = M[17]; // 8,1 = 1,8
  M[74] = M[26]; // 8,2 = 2,8
  M[75] = M[35]; // 8,3 = 3,8
  M[76] = M[44]; // 8,4 = 4,8
  M[77] = M[53]; // 8,5 = 5,8
  M[78] = M[62]; // 8,6 = 6,8
  M[79] = M[71]; // 8,7 = 7,8
}
