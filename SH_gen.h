SH_product_3(const double *a, const double *b, double &*c)
{
  double ta, tb, t

  // [0,0], 0
  c[0] = 0.282095*b[0]*a[0]

  // [1,1], 0, 6, 8
  ta = 0.282095*a[0] + -0.126157*a[6] + -0.218509*a[8]
  tb = 0.282095*b[0] + -0.126157*b[6] + -0.218509*b[8]
  c[1] = ta*b[1] + tb*a[1]
  t = a[1]*b[1]
  c[0] += 0.282095*t
  c[6] = -0.126157*t
  c[8] = -0.218509*t

  // [1,2], 5
  ta = 0.218509*a[5]
  tb = 0.218509*b[5]
  c[1] += ta*b[2] + tb*a[2]
  c[2] = ta*b[1] + tb*a[1]
  t = a[1]*b[2] + a[2]*b[1]
  c[5] = 0.218509*t

  // [1,3], 4
  ta = 0.21851*a[4]
  tb = 0.21851*b[4]
  c[1] += ta*b[3] + tb*a[3]
  c[3] = ta*b[1] + tb*a[1]
  t = a[1]*b[3] + a[3]*b[1]
  c[4] = 0.21851*t

  // [2,2], 0, 6
  ta = 0.282095*a[0] + 0.252313*a[6]
  tb = 0.282095*b[0] + 0.252313*b[6]
  c[2] += ta*b[2] + tb*a[2]
  t = a[2]*b[2]
  c[0] += 0.282095*t
  c[6] += 0.252313*t

  // [2,3], 7
  ta = 0.21851*a[7]
  tb = 0.21851*b[7]
  c[2] += ta*b[3] + tb*a[3]
  c[3] += ta*b[2] + tb*a[2]
  t = a[2]*b[3] + a[3]*b[2]
  c[7] = 0.21851*t

  // [3,3], 0, 6, 8
  ta = 0.282095*a[0] + -0.126157*a[6] + 0.21851*a[8]
  tb = 0.282095*b[0] + -0.126157*b[6] + 0.21851*b[8]
  c[3] += ta*b[3] + tb*a[3]
  t = a[3]*b[3]
  c[0] += 0.282095*t
  c[6] += -0.126157*t
  c[8] += 0.21851*t

  // [4,4], 0, 6
  ta = 0.282095*a[0] + -0.180224*a[6]
  tb = 0.282095*b[0] + -0.180224*b[6]
  c[4] += ta*b[4] + tb*a[4]
  t = a[4]*b[4]
  c[0] += 0.282095*t
  c[6] += -0.180224*t

  // [4,5], 7
  ta = 0.156078*a[7]
  tb = 0.156078*b[7]
  c[4] += ta*b[5] + tb*a[5]
  c[5] += ta*b[4] + tb*a[4]
  t = a[4]*b[5] + a[5]*b[4]
  c[7] += 0.156078*t

  // [5,5], 0, 6, 8
  ta = 0.282095*a[0] + 0.0901118*a[6] + -0.156078*a[8]
  tb = 0.282095*b[0] + 0.0901118*b[6] + -0.156078*b[8]
  c[5] += ta*b[5] + tb*a[5]
  t = a[5]*b[5]
  c[0] += 0.282095*t
  c[6] += 0.0901118*t
  c[8] += -0.156078*t

  // [6,6], 0, 6
  ta = 0.282095*a[0]
  tb = 0.282095*b[0]
  c[6] += ta*b[6] + tb*a[6]
  t = a[6]*b[6]
  c[0] += 0.282095*t
  c[6] += 0.180223*t

  // [7,7], 0, 6, 8
  ta = 0.282095*a[0] + 0.0901121*a[6] + 0.156079*a[8]
  tb = 0.282095*b[0] + 0.0901121*b[6] + 0.156079*b[8]
  c[7] += ta*b[7] + tb*a[7]
  t = a[7]*b[7]
  c[0] += 0.282095*t
  c[6] += 0.0901121*t
  c[8] += 0.156079*t

  // [8,8], 0, 6
  ta = 0.282095*a[0] + -0.180224*a[6]
  tb = 0.282095*b[0] + -0.180224*b[6]
  c[8] += ta*b[8] + tb*a[8]
  t = a[8]*b[8]
  c[0] += 0.282095*t
  c[6] += -0.180224*t

  // entry count: 13
  // multiply count: 106
  // addition count: 68
}

SH_square_3(const double *a, double *c)
{
  double ta, t

  // [0,0], 0
  c[0] = 0.282095*a[0]*a[0]

  // [1,1], 0, 6, 8
  ta = 0.56419*a[0] + -0.252314*a[6] + -0.437018*a[8]
  c[1] = ta*a[1]
  t = a[1]*a[1]
  c[0] += 0.282095*t
  c[6] = -0.126157*t
  c[8] = -0.218509*t

  // [1,2], 5
  ta = 0.437018*a[5]
  c[1] += ta*a[2]
  c[2] = ta*a[1]
  t = a[1]*a[2]
  c[5] = 0.437018*t

  // [1,3], 4
  ta = 0.43702*a[4]
  c[1] += ta*a[3]
  c[3] = ta*a[1]
  t = a[1]*a[3]
  c[4] = 0.43702*t

  // [2,2], 0, 6
  ta = 0.56419*a[0] + 0.504626*a[6]
  c[2] += ta*a[2]
  t = a[2]*a[2]
  c[0] += 0.282095*t
  c[6] += 0.252313*t

  // [2,3], 7
  ta = 0.43702*a[7]
  c[2] += ta*a[3]
  c[3] += ta*a[2]
  t = a[2]*a[3]
  c[7] = 0.43702*t

  // [3,3], 0, 6, 8
  ta = 0.56419*a[0] + -0.252314*a[6] + 0.43702*a[8]
  c[3] += ta*a[3]
  t = a[3]*a[3]
  c[0] += 0.282095*t
  c[6] += -0.126157*t
  c[8] += 0.21851*t

  // [4,4], 0, 6
  ta = 0.56419*a[0] + -0.360448*a[6]
  c[4] += ta*a[4]
  t = a[4]*a[4]
  c[0] += 0.282095*t
  c[6] += -0.180224*t

  // [4,5], 7
  ta = 0.312156*a[7]
  c[4] += ta*a[5]
  c[5] += ta*a[4]
  t = a[4]*a[5]
  c[7] += 0.312156*t

  // [5,5], 0, 6, 8
  ta = 0.56419*a[0] + 0.1802236*a[6] + -0.312156*a[8]
  c[5] += ta*a[5]
  t = a[5]*a[5]
  c[0] += 0.282095*t
  c[6] += 0.0901118*t
  c[8] += -0.156078*t

  // [6,6], 0, 6
  ta = 0.56419*a[0]
  c[6] += ta*a[6]
  t = a[6]*a[6]
  c[0] += 0.282095*t
  c[6] += 0.180223*t

  // [7,7], 0, 6, 8
  ta = 0.56419*a[0] + 0.1802242*a[6] + 0.312158*a[8]
  c[7] += ta*a[7]
  t = a[7]*a[7]
  c[0] += 0.282095*t
  c[6] += 0.0901121*t
  c[8] += 0.156079*t

  // [8,8], 0, 6
  ta = 0.56419*a[0] + -0.360448*a[6]
  c[8] += ta*a[8]
  t = a[8]*a[8]
  c[0] += 0.282095*t
  c[6] += -0.180224*t

  // entry count: 13
  // multiply count: 78
  // addition count: 52
}
